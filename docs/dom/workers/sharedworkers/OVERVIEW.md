## Key Classes


```searchfox-graph-v1
{
  "mode": "blockly-v1",
  "xml": "<xml xmlns=\"https://developers.google.com/blockly/xml\"><variables><variable id=\"Q/F|$F-$T)y_tVPeRw0u\">SharedWorkerChild</variable><variable id=\"JkuyV$juH`1NHuhWOia|\">SharedWorkerService</variable><variable id=\"v]o]ApIoLeltlK00;39d\">SharedWorkerParent</variable><variable id=\"T]GXqUG=(NRISR.1z%i~\">SharedWorkerManager</variable></variables><block type=\"cluster_process\" id=\"uCvM#PQ*V+y#J])i4WCH\" x=\"131\" y=\"0\"><field name=\"NAME\">Content 1</field><statement name=\"CHILDREN\"><block type=\"cluster_thread\" id=\"LCG~)p/85=5G#iI-(gz4\"><field name=\"NAME\">Main</field><statement name=\"CHILDREN\"><block type=\"node_class\" id=\"^MnOT.|m:Uq#r5NUJxY[\"><field name=\"NAME\" id=\"Q/F|$F-$T)y_tVPeRw0u\">SharedWorkerChild</field><statement name=\"METHODS\"><block type=\"edge_call\" id=\"(`GJ,XXF(Rr[TAzR@s!u\"><field name=\"CALLS_WHAT\" id=\"v]o]ApIoLeltlK00;39d\">SharedWorkerParent</field></block></statement></block></statement></block></statement></block><block type=\"cluster_process\" id=\"lS`9o{={SY%P.?+5Nf:o\" x=\"367\" y=\"30\"><field name=\"NAME\">Content 2</field><statement name=\"CHILDREN\"><block type=\"cluster_thread\" id=\"ZVH_-+DT/gJg55PPP}pP\"><field name=\"NAME\">Worker Launcher</field></block></statement></block><block type=\"cluster_process\" id=\"1y]-]c;?@MAJB%;o4V+|\" x=\"27\" y=\"152\"><field name=\"NAME\">Parent</field><statement name=\"CHILDREN\"><block type=\"cluster_thread\" id=\"o7B)5vHUmy*+E,D)F9y(\"><field name=\"NAME\">PBackground</field><statement name=\"CHILDREN\"><block type=\"node_class\" id=\"99-%Rzf*#7A!Tf*3%tQA\"><field name=\"NAME\" id=\"JkuyV$juH`1NHuhWOia|\">SharedWorkerService</field><next><block type=\"node_class\" id=\"bzQ_Jphh#3BqgK^NVU-Q\"><field name=\"NAME\" id=\"v]o]ApIoLeltlK00;39d\">SharedWorkerParent</field><statement name=\"METHODS\"><block type=\"edge_call\" id=\"o@*Y2=:Hq`W|Zli.IA{J\"><field name=\"CALLS_WHAT\" id=\"JkuyV$juH`1NHuhWOia|\">SharedWorkerService</field><next><block type=\"edge_call\" id=\"|P]O.G{rz9rb/ae$SZ[f\"><field name=\"CALLS_WHAT\" id=\"T]GXqUG=(NRISR.1z%i~\">SharedWorkerManager</field></block></next></block></statement><next><block type=\"node_class\" id=\"T0=?:}s:#VP;N3CA+;K1\"><field name=\"NAME\" id=\"T]GXqUG=(NRISR.1z%i~\">SharedWorkerManager</field></block></next></block></next></block></statement></block></statement></block></xml>",
  "svg": "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\n<!-- Generated by graphviz version 2.40.1 (20161225.0304)\n -->\n<!-- Pages: 1 -->\n<svg width=\"472pt\" height=\"268pt\"\n viewBox=\"0.00 0.00 471.59 268.00\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n<g id=\"graph0\" class=\"graph\" transform=\"scale(1 1) rotate(0) translate(4 264)\">\n<polygon fill=\"#ffffff\" stroke=\"transparent\" points=\"-4,4 -4,-264 467.589,-264 467.589,4 -4,4\"/>\n<g id=\"clust1\" class=\"cluster\">\n<polygon fill=\"none\" stroke=\"#000000\" points=\"16.339,-134 16.339,-252 151.563,-252 151.563,-134 16.339,-134\"/>\n<text text-anchor=\"middle\" x=\"83.951\" y=\"-235.4\" font-family=\"Arial\" font-size=\"14.00\" fill=\"#000000\">Content 1</text>\n</g>\n<g id=\"clust2\" class=\"cluster\">\n<polygon fill=\"none\" stroke=\"#000000\" points=\"24.339,-142 24.339,-219 143.563,-219 143.563,-142 24.339,-142\"/>\n<text text-anchor=\"middle\" x=\"83.951\" y=\"-202.4\" font-family=\"Arial\" font-size=\"14.00\" fill=\"#000000\">Main</text>\n</g>\n<g id=\"clust5\" class=\"cluster\">\n<polygon fill=\"none\" stroke=\"#000000\" points=\"8,-8 8,-126 455.589,-126 455.589,-8 8,-8\"/>\n<text text-anchor=\"middle\" x=\"231.7945\" y=\"-109.4\" font-family=\"Arial\" font-size=\"14.00\" fill=\"#000000\">Parent</text>\n</g>\n<g id=\"clust6\" class=\"cluster\">\n<polygon fill=\"none\" stroke=\"#000000\" points=\"16,-16 16,-93 447.589,-93 447.589,-16 16,-16\"/>\n<text text-anchor=\"middle\" x=\"231.7945\" y=\"-76.4\" font-family=\"Arial\" font-size=\"14.00\" fill=\"#000000\">PBackground</text>\n</g>\n<!-- n2 -->\n<g id=\"node1\" class=\"node\" data-symbols=T_mozilla::dom::SharedWorkerChild>\n<text text-anchor=\"middle\" x=\"83.951\" y=\"-165\" font-family=\"Arial\" font-size=\"10.00\" fill=\"#000000\">SharedWorkerChild</text>\n</g>\n<!-- n8 -->\n<g id=\"node3\" class=\"node\" data-symbols=T_mozilla::dom::SharedWorkerParent>\n<text text-anchor=\"middle\" x=\"234.8535\" y=\"-39\" font-family=\"Arial\" font-size=\"10.00\" fill=\"#000000\">SharedWorkerParent</text>\n</g>\n<!-- n2&#45;&gt;n8 -->\n<g id=\"edge2\" class=\"edge\">\n<path fill=\"none\" stroke=\"#000000\" d=\"M105.5716,-149.9473C131.7929,-128.0531 176.113,-91.047 205.4295,-66.5683\"/>\n<polygon fill=\"#000000\" stroke=\"#000000\" points=\"213.273,-60.0192 208.4811,-69.8828 209.4349,-63.2239 205.5969,-66.4286 205.5969,-66.4286 205.5969,-66.4286 209.4349,-63.2239 202.7127,-62.9743 213.273,-60.0192 213.273,-60.0192\"/>\n</g>\n<!-- n7 -->\n<g id=\"node2\" class=\"node\" data-symbols=_ZN7mozilla3dom19SharedWorkerServiceC1Ev>\n<text text-anchor=\"middle\" x=\"382.697\" y=\"-39\" font-family=\"Arial\" font-size=\"10.00\" fill=\"#000000\">SharedWorkerService</text>\n</g>\n<!-- n8&#45;&gt;n7 -->\n<g id=\"edge1\" class=\"edge\">\n<path fill=\"none\" stroke=\"#000000\" d=\"M289.905,-42C298.2841,-42 307.0098,-42 315.6111,-42\"/>\n<polygon fill=\"#000000\" stroke=\"#000000\" points=\"325.6228,-42 315.6228,-46.5001 320.6228,-42 315.6228,-42.0001 315.6228,-42.0001 315.6228,-42.0001 320.6228,-42 315.6227,-37.5001 325.6228,-42 325.6228,-42\"/>\n</g>\n<!-- n9 -->\n<g id=\"node4\" class=\"node\" data-symbols=_ZN7mozilla3dom19SharedWorkerManagerC1EP14nsIEventTargetRKNS0_16RemoteWorkerDataEP12nsIPrincipalRKNS_16OriginAttributesE>\n<text text-anchor=\"middle\" x=\"83.951\" y=\"-39\" font-family=\"Arial\" font-size=\"10.00\" fill=\"#000000\">SharedWorkerManager</text>\n</g>\n</g>\n</svg>\n"
}
```


- `SharedWorker`: DOM binding.  Holds a `SharedWorkerChild`.  Must exist on the main
  thread because we only allow top-level windows to create SharedWorkers.
- `SharedWorkerChild`: Held by `SharedWorker` bindings to remotely control
  sharedworker lifecycle and receive error and termination reports.
- `PSharedWorker`: Protocol for `SharedWorker` bindings to communicate with
  per-worker SharedWorkerManager instances in the parent via `SharedWorkerChild`/
  `SharedWorkerParent` and `SharedWorkerService` getting/creating the
  `SharedWorkerManager` if it doesn't already exist.  Main-thread to `PBackground`.
- `SharedWorkerParent`: `PBackground` actor that relays life-cycle events
  (freeze/thaw, suspend/resume, close) to the `PBackground` `SharedWorkerManager`
  and relays error/termination back to the child.
- `SharedWorkerService`: `PBackground` service that creates and tracks the
  per-worker SharedWorkerManager instances, allowing rendezvous between
  `SharedWorkerParent` instances and the `SharedWorkerManager`s they want to talk to
  (1:1).
- `SharedWorkerManager`: `PBackground` instance that corresponds to a single logical
  Shared Worker that exists somewhere in the process tree.  Referenced/owned by
  multiple `SharedWorkerParent` instances on the `PBackground` thread.  Holds/owns
  a single `RemoteWorkerController` to interact with the actual shared worker
  thread, wherever it is located.  Creates the `RemoteWorkerController` via
  `RemoteWorkerController::Create` which uses `RemoteWorkerManager::Launch` under
  the hood.
- `SharedWorkerManagerWrapper`: Holds a reference to a `SharedWorkerManagerHolder`
  that it ensures is released on the main-thread only.

## Starting a SharedWorker
